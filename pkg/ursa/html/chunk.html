<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Get indices for partial image reading/writing</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="file:///C:/Software/R/doc/html/R.css" />
</head><body>

<table width="100%" summary="page for chunk"><tr><td>chunk</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>
Get indices for partial image reading/writing
</h2>

<h3>Description</h3>

<p>In the case of 'Cannot allocate vector of size ...' error message <code>chunk.band</code> returns list of bands indices, which are suitable for allocation in memory at once, <code>chunk.line</code> returns list of lines (rows) indices, which are suitable for allocation in memory at once. <code>chunk.expand</code> is used to expand lines indices and can by applied in focal functions.
</p>


<h3>Usage</h3>

<pre>
chunk.band(obj, mem = 100)
chunk.line(obj, mem = 100)
chunk.expand(ind, size = 3)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>obj</code></td>
<td>

<p>Object of class <code>rmapRaster</code>
</p>
</td></tr>
<tr valign="top"><td><code>mem</code></td>
<td>

<p>Nunmeric. Memory size in GB, which is suitable for allocation.
</p>
</td></tr>
<tr valign="top"><td><code>ind</code></td>
<td>

<p>Integer. Line indices.
</p>
</td></tr>
<tr valign="top"><td><code>size</code></td>
<td>

<p>Integer. Size of focal window.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>chunk.band</code> returns list with sequences of bands
</p>
<p><code>chunk.line</code> returns list with sequences of lines
</p>
<p><code>chunk.expand</code> returns list:
</p>
<table summary="R valueblock">
<tr valign="top"><td><code>src</code></td>
<td>
<p>expanded set if line indices</p>
</td></tr>
<tr valign="top"><td><code>dst</code></td>
<td>
<p>matching of source indices in the expanded set</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Nikita Platonov <a href="mailto:platonov@sevin.ru">platonov@sevin.ru</a>
</p>


<h3>Examples</h3>

<pre>
 ## 1. Prepare data
 session.grid(NULL)
 fname &lt;- rmap:::.maketmp(2)
 a &lt;- envi.create(fname[1],nband=3,ignorevalue=-99)
 for (i in seq(nband(a)))
   a[i] &lt;- pixelsize()^(1/i)
 close(a)
 rm(a)
 
 ## 2. Read 
 a &lt;- envi.open(fname[1])
 chB &lt;- chunk.band(a,2)
 print(str(chB))
 for (i in chB)
    print(a[i])
 chL &lt;- chunk.line(a,2.5)
 print(str(chL))
 for (j in chL)
    print(a[,j])
 
 ## 3. Filtering with partial reading
 b &lt;- envi.create(a,fname[2])
 fsize &lt;- 15
 for (j in chL) {
    k &lt;- chunk.expand(j,fsize)
    b[,j] &lt;- focal.mean(a[,k$src],size=fsize)[,k$dst]
 }
 d1 &lt;- b[]
 
 ##  4. Filtering in memory
 d2 &lt;- focal.mean(a[],size=fsize)
 close(a,b)
 envi.remove(fname)
 print(d1-d2)
</pre>


</body></html>
